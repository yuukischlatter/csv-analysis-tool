/**
 * PDF Generator Service for Schlatter Speed Check Reports
 * Adapted from standalone version to work with React app data
 */

import { jsPDF } from 'jspdf';
import 'jspdf-autotable';
import { createPDFDataPackage } from '../utils/pdfDataMapper';

// Get version from package.json
const getAppVersion = () => {
  try {
    // In Electron environment, we can access the main process
    if (window.require) {
      const { remote } = window.require('electron');
      const app = remote ? remote.app : window.require('electron').app;
      return app.getVersion();
    }
    
    // Fallback: try to read package.json directly
    if (window.fs && window.fs.readFileSync) {
      const packageJson = JSON.parse(window.fs.readFileSync('package.json', 'utf8'));
      return packageJson.version;
    }
    
    // If neither works, return a default
    return '1.0.0';
  } catch (error) {
    console.warn('Could not retrieve app version:', error);
    return '1.0.0';
  }
};

/**
 * Main PDF generation function
 * @param {Object} reactData - Data from React app
 */
export const generatePDF = (reactData) => {
  try {
    console.log('Starting PDF generation...');
    
    // Transform React data to PDF format
    const pdfData = createPDFDataPackage(reactData);
    
    const doc = new jsPDF({
      orientation: 'portrait',
      unit: 'mm',
      format: 'a4'
    });
    
    const pageWidth = 210;
    const pageHeight = 297;
    
    // Schlatter brand colors
    const colors = {
      schlatterBlue: [0, 50, 120],
      schlatterRed: [220, 50, 50],
      text: [51, 51, 51],
      textLight: [102, 102, 102],
      border: [200, 200, 200],
      background: [248, 249, 250]
    };
    
    addHeader(doc, pageWidth, colors);
    addInfoBoxes(doc, pdfData.testFormData, colors);
    addResultsSection(doc, pdfData.voltageData, pdfData.speedCheckResults, pdfData.systemParameters, pageWidth, colors);
    
    // Add version information at bottom left
    addVersionInfo(doc, colors);
    
    doc.save(pdfData.filename);
    console.log(`PDF generated: ${pdfData.filename}`);
    
  } catch (error) {
    console.error('PDF generation failed:', error);
    throw new Error(`PDF generation failed: ${error.message}`);
  }
};

function addVersionInfo(doc, colors) {
  const version = getAppVersion();
  
  doc.setFontSize(7);
  doc.setFont("helvetica", "normal");
  doc.setTextColor(...colors.textLight);
  
  // Position at bottom left (20mm from left, 290mm from top)
  doc.text(`SpeedChecker v${version}`, 20, 290);
}

function addHeader(doc, pageWidth, colors) {
  // Title - moved up by 6mm
  doc.setFontSize(16);
  doc.setFont("helvetica", "bold");
  doc.setTextColor(...colors.text);
  doc.text("Protokoll zur Geschwindigkeitsmessung", 20, 18);
  
  // Underline - moved up by 6mm
  doc.setDrawColor(...colors.border);
  doc.setLineWidth(0.3);
  doc.line(20, 21, pageWidth - 82, 21);
  
  // Logo placeholder - moved up by 6mm
  const logoBase64 = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA3YAAAFwCAYAAAD0a+m5AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAADrGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4NCjx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAzIDc5Ljk2OTBhODdmYywgMjAyNS8wMy8wNi0yMDo1MDoxNiAgICAgICAgIj4NCgk8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPg0KCQk8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjAyNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QUI1QzA4Nzk0MkIzMTFGMEE2NjU5NEUzNzRFQzdDRUEiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QUI1QzA4N0E0MkIzMTFGMEE2NjU5NEUzNzRFQzdDRUEiPg0KCQkJPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QUI1QzA4Nzc0MkIzMTFGMEE2NjU5NEUzNzRFQzdDRUEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QUI1QzA4Nzg0MkIzMTFGMEE2NjU5NEUzNzRFQzdDRUEiLz4NCgkJPC9yZGY6RGVzY3JpcHRpb24+DQoJCTxyZGY6RGVzY3JpcHRpb24geG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPjx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+PC9yZGY6RGVzY3JpcHRpb24+PC9yZGY6UkRGPg0KPC94OnhtcG1ldGE+DQo8P3hwYWNrZXQgZW5kPSd3Jz8+C4kJ0wAAbHxJREFUeF7t3XeYFPX9B/D3zPZyt9cLd9Q7OHqRogIKIogoKsWWYpomxhhL7D3GFmONxhij6flpLFhAsYMiFlQQ6b0fXC9726f+/lgwOhG4LXe3c/d+Pc8lz7OfBbnZ2Zl5f6ug67oOIiIiIiIiMi3R+AIRERERERGZC4MdERERERGRyTHYERERERERmRyDHRERERERkckx2BEREREREZkcgx0REREREZHJMdgRERERERGZHIMdERERERGRyTHYERERERERmRyDHRERERERkckx2BEREREREZkcgx0REREREZHJMdgRERERERGZHIMdERERERGRyTHYERERERERmRyDHRERERERkckx2BEREREREZkcgx0REREREZHJMdgRERERERGZHIMdERERERGRyTHYERERERERmRyDHRERERERkckx2BEREREREZkcgx0REREREZHJMdgRERERERGZHIMdERERERGRyTHYERERERERmRyDHRERERERkckx2BEREREREZkcgx0REREREZHJMdgRERERERGZHIMdERERERGRyTHYERERERERmRyDHRERERERkckx2BEREREREZkcgx0REREREZHJMdgRERERERGZHIMdERERERGRyTHYERERERERmRyDHRERERERkckx2BEREREREZkcgx0REREREZHJMdgRERERERGZHIMdERERERGRyTHYERERERERmRyDHRERERERkckx2BEREREREZkcgx0REREREZHJMdgRERERERGZHIMdERERERGRyTHYERERERERmRyDHRERERERkckx2BEREREREZkcgx0REREREZHJMdgRERERERGZHIMdERERERGRyTHYERERERERmRyDHRERERERkckx2BEREREREZkcgx0REREREZHJMdgRERERERGZHIMdERERERGRyTHYERERERERmRyDHRERERERkckx2BEREREREZkcgx0REREREZHJMdgRERERERGZHIMdERERERGRyTHYERERERERmRyDHRERERERkckx2BEREREREZkcgx0REREREZHJMdgRERERERGZHIMdERERERGRyTHYERERERERmRyDHRERERERkckx2BEREREREZkcgx0REREREZHJMdgRERERERGZHIMdERERERGRyTHYERERERERmRyDHRERERERkckJuq7rxhfJXHQAmqYBEIwlIiIiIqIeR4cOAQIsYs95PmawMzlJVvGTu97G/voArFaLsUxERERE1KPoug6LKOD3V52EIf3yjOVui8HO5NbvbMLxP38OwZAEWDmyloiIiIh6OEVDeYEHq/91AQp8TmO122KwM7nnlmzF+Xe8iSy7FT2op5mIiIiI6Fv5ozLmT6rAC/fMhtCDno/ZxWNyazbXA7LKUEdEREREBACqhnFDintUqAODnblpuo7PN9dBtFmNJSIiIiKiHkfVdDidNoyozDeWuj0GOxOrbQpj694WODm3joiIiIgImq6jyOvA6IFFxlK3x0RgYmu2N6AhFIOFnyIRERERESRVw6A+eSjN9xhL3R4jgYmt396ISESC2NMGEBMRERERfQtFVjFhSAnEHrgABYOdia3b3gCumkJEREREBGg6AKuIoRUFxlKPwGBnUoGQjC+21MPFhVOIiIiIiKBqOgq9Tgwf0PMWTgGDnXlt3deC/c1hiBb22BERERERyZqG3oVeDOmXayz1CAx2JrVqcx1aIxJEMNgREREREcmyirFVRbDbLMZSj8BgZ1IbdjQCqs4pdkREREREiE+yG1tVbHy1x2CwMyFJVrFuRyOsPbQ1goiIiIjo61RNh8fjQFX/PGOpx2CwM6HapjA27ePG5EREREREACBpGnrlODGsf89cOAUMdua0akstmoIxCNy/joiIiIgIsqKjql8BCnNcxlKPwWBnQl9uaYQsqZxfR0REREQEQFdUHDe0xPhyj8JgZzKapmPt9kYI3OaAiIiIiAiargM2EaMG9cyNyQ9hsDOZprYY1u9uhIMLpxARERERQVE19M71oKpvz104BQx25rN1TzMONIVgE/nRERERERHFVB0VpT5UlvmMpR6F6cBkPttUi7DM+XVERERERACgqRpGVxX2+IUFGexMZt32BkDTjS8TEREREfVMuo6xg3vuxuSHMNiZSDAs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";
  
  try {
    if (logoBase64 !== "") {
      doc.addImage(logoBase64, 'PNG', pageWidth - 74, 2, 63, 26);
    } else {
      throw new Error('Logo placeholder');
    }
  } catch (error) {
    console.warn('Logo not loaded, using text fallback');
    
    // Fallback to text - moved up by 6mm
    doc.setFontSize(12);
    doc.setFont("helvetica", "normal");
    doc.setTextColor(...colors.schlatterBlue);
    doc.text("schlatter", pageWidth - 45, 12);
    
    // Logo box border - moved up by 6mm
    doc.setDrawColor(...colors.schlatterBlue);
    doc.setLineWidth(0.5);
    doc.rect(pageWidth - 50, 6, 40, 12);
  }
  
  // Reset colors
  doc.setTextColor(...colors.text);
  doc.setDrawColor(...colors.border);
}

function addInfoBoxes(doc, testData, colors) {
  const boxWidth = 85;
  const uniformBoxHeight = 38; // Uniform height for both bottom boxes
  const reducedBoxHeight = 25; // Height for top boxes
  const startY = 28; // Moved up by 7mm (was 35)
  const leftX = 20;
  const rightX = 110;
  
  // Helper function to format date from YYYY-MM-DD to DD.MM.YYYY
  const formatDateForPDF = (isoDate) => {
    if (!isoDate) return '';
    try {
      const [year, month, day] = isoDate.split('-');
      return `${day}.${month}.${year}`;
    } catch (error) {
      return isoDate;
    }
  };
  
  doc.setFontSize(10);
  doc.setFont("helvetica", "normal");
  doc.setDrawColor(...colors.border);
  doc.setLineWidth(0.3);
  
  // Top row: Auftragsdaten (left) and Prüfung (right) - both small boxes
  addInfoBox(doc, "Auftragsdaten", leftX, startY, boxWidth, reducedBoxHeight, [
    ["Auftrags-Nr.:", testData.auftragsNr || ""],
    ["Maschinentyp:", testData.maschinentyp || ""]
  ], colors);
  
  addInfoBox(doc, "Prüfung", rightX, startY, boxWidth, reducedBoxHeight, [
    ["Prüfer:", testData.pruefer || ""],
    ["Datum:", testData.datumFormatted || formatDateForPDF(testData.datum) || ""]
  ], colors);
  
  // Bottom row: Both boxes now have uniform height of 38mm
  addInfoBox(doc, "Regelventil", leftX, startY + reducedBoxHeight + 5, boxWidth, uniformBoxHeight, [
    ["Art.-Nr. S-CH:", testData.artNrSCH || ""],
    ["Art.-Nr. Parker:", wrapText(testData.artNrParker || "", 25)],
    ["Nenndurchfluss:", testData.nenndurchfluss || ""],
    ["S/N Parker:", testData.snParker || ""]
  ], colors);
  
  addInfoBox(doc, "Prüfbedingungen", rightX, startY + reducedBoxHeight + 5, boxWidth, uniformBoxHeight, [
    ["Offset Original:", (testData.ventilOffsetOriginal || "") + (testData.ventilOffsetOriginal ? " V" : "")],
    ["Parker Korrektur:", (testData.ventilOffsetKorrektur || "") + (testData.ventilOffsetKorrektur ? " %" : "")],
    ["Offset n. Korrektur:", (testData.ventilOffsetNachKorrektur || "0.00") + " V"],
    ["Druck am Ventil:", (testData.druckVentil || "") + (testData.druckVentil ? " bar" : "")],
    ["Öltemperatur:", (testData.oeltemperatur || "") + (testData.oeltemperatur ? " °C" : "")]
  ], colors);
}

function addInfoBox(doc, title, x, y, width, height, data, colors) {
  // Border
  doc.setDrawColor(...colors.border);
  doc.setLineWidth(0.3);
  doc.rect(x, y, width, height);
  
  // Title
  doc.setFont("helvetica", "bold");
  doc.setFontSize(11);
  doc.setTextColor(...colors.schlatterBlue);
  doc.text(title, x + 3, y + 7);
  
  // Title underline
  doc.setDrawColor(...colors.schlatterBlue);
  doc.setLineWidth(0.3);
  doc.line(x + 3, y + 9, x + width - 3, y + 9);
  
  // Data
  doc.setFont("helvetica", "normal");
  doc.setFontSize(9);
  
  let currentY = y + 16;
  const lineHeight = 4.5;
  
  data.forEach(([label, value]) => {
    if (currentY < y + height - 3) {
      // Label
      doc.setTextColor(...colors.textLight);
      doc.text(label, x + 3, currentY);
      
      // Value
      doc.setTextColor(...colors.text);
      doc.setFont("helvetica", "bold");
      
      const maxWidth = 35;
      const wrappedValue = wrapText(value, maxWidth);
      const lines = wrappedValue.split('\n');
      
      lines.forEach((line, lineIndex) => {
        if (currentY + (lineIndex * 3.5) < y + height - 3) {
          doc.text(line, x + 42, currentY + (lineIndex * 3.5));
        }
      });
      
      doc.setFont("helvetica", "normal");
      currentY += lineHeight + (lines.length > 1 ? 3 : 0);
    }
  });
  
  doc.setTextColor(...colors.text);
  doc.setDrawColor(...colors.border);
}

function wrapText(text, maxLength) {
  if (!text || text.length <= maxLength) return text;
  
  const words = text.split(' ');
  let result = '';
  let line = '';
  
  for (const word of words) {
    if ((line + word).length <= maxLength) {
      line += (line ? ' ' : '') + word;
    } else {
      if (result) result += '\n';
      result += line;
      line = word;
    }
  }
  
  if (line) {
    if (result) result += '\n';
    result += line;
  }
  
  return result;
}

function addResultsSection(doc, voltageData, speedCheckResults, systemParameters, pageWidth, colors) {
  // Keep all positions exactly the same as before
  const tableSectionY = 105;
  const chartSectionY = 115;
  const tableWidth = 28;
  const chartX = 67;
  const chartWidth = 130;
  const chartHeight = 124;
  
  addExtendedMeasurementTable(doc, voltageData, 20, tableSectionY, tableWidth, colors);
  addChart(doc, voltageData, speedCheckResults, chartX, chartSectionY, chartWidth, chartHeight, colors);
  addSystemParametersUnderChart(doc, systemParameters, chartX, chartSectionY + chartHeight + 18, chartWidth, colors);
}

function addExtendedMeasurementTable(doc, data, x, y, width, colors) {
  // Header
  doc.setFont("helvetica", "bold");
  doc.setFontSize(11);
  doc.setTextColor(...colors.schlatterBlue);
  
  doc.setFillColor(...colors.background);
  doc.rect(x, y, width, 8, 'F');
  doc.setDrawColor(...colors.border);
  doc.setLineWidth(0.3);
  doc.rect(x, y, width, 8);
  doc.text("Messwerte", x + width/2 - 10, y + 5.5);
  
  // Column headers
  doc.setFontSize(6.5);
  doc.setFont("helvetica", "bold");
  doc.setTextColor(...colors.text);
  
  doc.setFillColor(250, 250, 250);
  doc.rect(x, y + 8, width/2, 32, 'F');
  doc.rect(x + width/2, y + 8, width/2, 32, 'F');
  doc.rect(x, y + 8, width, 32);
  doc.line(x + width/2, y + 8, x + width/2, y + 40);
  
  doc.text("Eingangsspannung UE [V]", x + width/4 - 1, y + 38, { angle: 90 });
  doc.text("Schlittengeschw. v [mm/s]", x + 3*width/4 - 1, y + 38, { angle: 90 });
  
  // Data rows
  doc.setFont("helvetica", "normal");
  doc.setFontSize(8.5);
  doc.setTextColor(...colors.text);
  
  let currentY = y + 40;
  const rowHeight = 4.1;
  const maxY = 277;
  
  data.forEach((row, index) => {
    if (currentY > maxY) return;
    
    if (index % 2 === 0) {
      doc.setFillColor(252, 252, 252);
      doc.rect(x, currentY, width, rowHeight, 'F');
    }
    
    doc.setDrawColor(...colors.border);
    doc.setLineWidth(0.1);
    doc.rect(x, currentY, width, rowHeight);
    doc.line(x + width/2, currentY, x + width/2, currentY + rowHeight);
    
    doc.text(row.voltage.toFixed(2), x + width/4 - 2, currentY + 2.8, { align: 'center' });
    doc.text(row.velocity.toFixed(2), x + 3*width/4 - 2, currentY + 2.8, { align: 'center' });
    currentY += rowHeight;
  });
}

function addChart(doc, data, speedCheckResults, x, y, width, height, colors) {
  // Chart title
  doc.setFont("helvetica", "bold");
  doc.setFontSize(10);
  doc.setTextColor(...colors.schlatterBlue);
  doc.text("Diagramm der Messwerte und Regressionsgerade", x + width/2 - 45, y - 4);
  
  // Chart border
  doc.setDrawColor(...colors.border);
  doc.setLineWidth(0.4);
  doc.rect(x, y, width, height);
  
  // Calculate scales
  const voltageRange = [-10, 10];
  const velocityRange = calculateVelocityRange(data);
  
  const xScale = width / (voltageRange[1] - voltageRange[0]);
  const yScale = height / (velocityRange[1] - velocityRange[0]);
  
  addChartGrid(doc, x, y, width, height, voltageRange, velocityRange, xScale, yScale, colors);
  addChartAxes(doc, x, y, width, height, voltageRange, velocityRange, colors);
  addChartDataPoints(doc, data, x, y, voltageRange, velocityRange, xScale, yScale, colors);
  addRedRegressionLine(doc, speedCheckResults, x, y, width, height, voltageRange, velocityRange, xScale, yScale, colors);
}

function calculateVelocityRange(data) {
  const velocities = data.map(d => d.velocity);
  const min = Math.min(...velocities);
  const max = Math.max(...velocities);
  const buffer = (max - min) * 0.1;
  return [min - buffer, max + buffer];
}

function addChartGrid(doc, x, y, width, height, voltageRange, velocityRange, xScale, yScale, colors) {
  doc.setDrawColor(240, 240, 240);
  doc.setLineWidth(0.08);
  
  // Vertical grid lines
  for (let v = voltageRange[0]; v <= voltageRange[1]; v++) {
    const gridX = x + (v - voltageRange[0]) * xScale;
    doc.line(gridX, y, gridX, y + height);
  }
  
  // Horizontal grid lines
  const step = Math.ceil((velocityRange[1] - velocityRange[0]) / 20);
  for (let v = Math.ceil(velocityRange[0]); v <= velocityRange[1]; v += step) {
    const gridY = y + height - (v - velocityRange[0]) * yScale;
    doc.line(x, gridY, x + width, gridY);
  }
  
  // Zero lines
  doc.setDrawColor(220, 220, 220);
  doc.setLineWidth(0.15);
  
  const zeroX = x + (0 - voltageRange[0]) * xScale;
  doc.line(zeroX, y, zeroX, y + height);
  
  const zeroY = y + height - (0 - velocityRange[0]) * yScale;
  doc.line(x, zeroY, x + width, zeroY);
  
  doc.setDrawColor(...colors.border);
  doc.setLineWidth(0.3);
}

function addChartAxes(doc, x, y, width, height, voltageRange, velocityRange, colors) {
  doc.setFontSize(8);
  doc.setFont("helvetica", "normal");
  doc.setTextColor(...colors.textLight);
  
  // Axis labels
  doc.text("Eingangsspannung UE [V]", x + width/2 - 16, y + height + 10);
  doc.text("Schlittengeschwindigkeit v [mm/s]", x - 10, y + height/2 + 20, { angle: 90 });
  
  // Tick labels
  doc.setFontSize(6.5);
  doc.setTextColor(...colors.text);
  
  // X-axis ticks
  for (let v = voltageRange[0]; v <= voltageRange[1]; v += 2) {
    const tickX = x + (v - voltageRange[0]) * (width / (voltageRange[1] - voltageRange[0]));
    doc.text(v.toString(), tickX - 2, y + height + 4);
    
    doc.setDrawColor(...colors.border);
    doc.line(tickX, y + height, tickX, y + height + 1);
  }
  
  // Y-axis ticks
  const step = Math.ceil((velocityRange[1] - velocityRange[0]) / 10);
  for (let v = Math.ceil(velocityRange[0]); v <= velocityRange[1]; v += step) {
    const tickY = y + height - (v - velocityRange[0]) * (height / (velocityRange[1] - velocityRange[0]));
    doc.text(v.toString(), x - 6, tickY + 1);
    doc.line(x - 1, tickY, x, tickY);
  }
}

function addChartDataPoints(doc, data, x, y, voltageRange, velocityRange, xScale, yScale, colors) {
  const sortedData = [...data].sort((a, b) => a.voltage - b.voltage);
  
  const chartPoints = sortedData.map(point => ({
    x: x + (point.voltage - voltageRange[0]) * xScale,
    y: y + (velocityRange[1] - point.velocity) * yScale
  }));
  
  // Connecting lines
  doc.setDrawColor(...colors.schlatterBlue);
  doc.setLineWidth(0.4);
  for (let i = 0; i < chartPoints.length - 1; i++) {
    doc.line(chartPoints[i].x, chartPoints[i].y, chartPoints[i + 1].x, chartPoints[i + 1].y);
  }
  
  // Data points
  doc.setFillColor(...colors.schlatterBlue);
  doc.setDrawColor(...colors.schlatterBlue);
  doc.setLineWidth(0.2);
  chartPoints.forEach(point => {
    doc.circle(point.x, point.y, 0.8, 'FD');
  });
}

function addRedRegressionLine(doc, speedCheckResults, x, y, width, height, voltageRange, velocityRange, xScale, yScale, colors) {
  doc.setDrawColor(...colors.schlatterRed);
  doc.setLineWidth(0.6);
  
  const slope = speedCheckResults.manualSlope || speedCheckResults.calculatedSlope;
  const intercept = speedCheckResults.intercept || 0;
  
  const startVoltage = voltageRange[0];
  const endVoltage = voltageRange[1];
  
  let startVelocity = slope * startVoltage + intercept;
  let endVelocity = slope * endVoltage + intercept;
  
  const minVelocity = velocityRange[0];
  const maxVelocity = velocityRange[1];
  
  let actualStartVoltage = startVoltage;
  let actualEndVoltage = endVoltage;
  
  if (startVelocity < minVelocity) {
    startVelocity = minVelocity;
    actualStartVoltage = (minVelocity - intercept) / slope;
  }
  if (startVelocity > maxVelocity) {
    startVelocity = maxVelocity;
    actualStartVoltage = (maxVelocity - intercept) / slope;
  }
  
  if (endVelocity < minVelocity) {
    endVelocity = minVelocity;
    actualEndVoltage = (minVelocity - intercept) / slope;
  }
  if (endVelocity > maxVelocity) {
    endVelocity = maxVelocity;
    actualEndVoltage = (maxVelocity - intercept) / slope;
  }
  
  const startX = x + (actualStartVoltage - voltageRange[0]) * xScale;
  const endX = x + (actualEndVoltage - voltageRange[0]) * xScale;
  const startY = y + height - (startVelocity - velocityRange[0]) * yScale;
  const endY = y + height - (endVelocity - velocityRange[0]) * yScale;
  
  doc.line(startX, startY, endX, endY);
  
  doc.setDrawColor(...colors.border);
  doc.setLineWidth(0.3);
}

function addSystemParametersUnderChart(doc, params, x, y, width, colors) {
  // Section header
  doc.setFont("helvetica", "bold");
  doc.setFontSize(10);
  doc.setTextColor(...colors.schlatterBlue);
  doc.text("Systemparameter für SWEP-Formular", x, y);
  
  // Underline
  doc.setDrawColor(...colors.schlatterBlue);
  doc.setLineWidth(0.3);
  doc.line(x, y + 2, x + width, y + 2);
  
  // Parameters
  doc.setFont("helvetica", "normal");
  doc.setFontSize(8);
  doc.setTextColor(...colors.text);
  
  const parameters = [
    [`Steigung der Regr.ger.`, `${params.slopeValue}`, `mm/s/V`],
    [`Geschw. bei 0.3 V`, `${params.speedAt03V}`, `mm/s`],
    [`Max. Geschw. bei 10 V`, `${params.maxSpeedAt10V}`, `mm/s`]
  ];
  
  let currentY = y + 8;
  parameters.forEach(([label, value, unit], index) => {
    if (index % 2 === 0) {
      doc.setFillColor(252, 252, 252);
      doc.rect(x, currentY - 2, width, 5, 'F');
    }
    
    doc.setTextColor(...colors.textLight);
    doc.text(label, x + 2, currentY);
    
    doc.setTextColor(...colors.text);
    doc.setFont("helvetica", "bold");
    doc.text(value, x + width - 30, currentY);
    doc.setFont("helvetica", "normal");
    
    doc.setTextColor(...colors.textLight);
    doc.text(unit, x + width - 15, currentY);
    
    currentY += 6;
  });
  
  // Date stamp
  doc.setFontSize(7);
  doc.setTextColor(...colors.textLight);
  const now = new Date();
  const timestamp = `${String(now.getDate()).padStart(2, '0')}.${String(now.getMonth() + 1).padStart(2, '0')}.${now.getFullYear()} / ${String(now.getHours()).padStart(2, '0')}:${String(now.getMinutes()).padStart(2, '0')}`;
  doc.text(timestamp, x + width - 22, currentY + 4);
  
  doc.setTextColor(...colors.text);
}